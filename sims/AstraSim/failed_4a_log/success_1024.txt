REACHED workload_cfg_to_et.py
workload_cfg:  /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
workload_et:  /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.%d.et
[0mVERSION:  2
astrasim_220_example/knobs_4.py
astrasim_220_example/network_input_4.yml
astrasim_220_example/system_input_4.json
astrasim_220_example/workload_cfg_4.json
[DEBUG][Seed] 12234
[DEBUG][RL Form] random_walker
[DEBUG][Max Steps] 50000
[DEBUG][Num Agents] 1
[DEBUG][Reward Formulation] both
[DEBUG][Reward Scaling] false
self.param_len:  0
system knobs:  {'scheduling-policy': ({'FIFO', 'LIFO'}, 'N/A'), 'preferred-dataset-splits': ({8, 16, 2, 4}, 'N/A'), 'all-reduce-implementation': ({'ring', 'halvingDoubling', 'direct', 'doubleBinaryTree'}, 'FALSE'), 'collective-optimization': ({'localBWAware', 'baseline'}, 'N/A')}
self.param_len:  7
network knobs:  {'topology': ({'FullyConnected', 'Switch', 'Ring'}, 'FALSE'), 'npus-count': ({8, 16, 4}, 'FALSE')}
self.param_len:  15
workload knobs:  {}
dimensions:  4
param_len:  15
_____________________*****************************_____________________
CONSTRAINTS:  ['product network npus-count == num workload num_npus', 'mult workload dp workload sp workload pp <= num workload num_npus']
DERIVED KNOBS:  ['network bandwidth', 'system implementations']
DIMENSION:  4
0 0 DIMENSION:  4
DIMENSION:  4
0 1 DIMENSION:  4
Step: 0
REWARD FORMULATION:  both
GENERATING WORKLOAD...
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 2 DIMENSION:  4
Step: 1
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [50, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 3 DIMENSION:  4
Step: 2
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 4 DIMENSION:  4
Step: 3
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 5 DIMENSION:  4
Step: 4
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 4, 8], 'bandwidth': [100, 100, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus_count': [4, 8, 4, 8], 'bandwidth': [100, 100, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:36:43.484] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 6 DIMENSION:  4
Step: 5
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [50, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 7 DIMENSION:  4
Step: 6
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 8, 16], 'bandwidth': [50, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 8 DIMENSION:  4
Step: 7
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 9 DIMENSION:  4
Step: 8
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 10 DIMENSION:  4
Step: 9
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 11 DIMENSION:  4
Step: 10
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:37:17.680] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 12 DIMENSION:  4
Step: 11
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [33.333333333333336, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 13 DIMENSION:  4
Step: 12
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:37:50.608] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 14 DIMENSION:  4
Step: 13
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 6.666666666666667, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 15 DIMENSION:  4
Step: 14
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 4, 8], 'bandwidth': [100, 14.285714285714286, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 16 DIMENSION:  4
Step: 15
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 33.333333333333336, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [33.333333333333336, 14.285714285714286, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 17 DIMENSION:  4
Step: 16
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [50, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 18 DIMENSION:  4
Step: 17
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 19 DIMENSION:  4
Step: 18
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [33.333333333333336, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [33.333333333333336, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:38:24.116] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 20 DIMENSION:  4
Step: 19
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [100, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 21 DIMENSION:  4
Step: 20
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 22 DIMENSION:  4
Step: 21
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 23 DIMENSION:  4
Step: 22
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 24 DIMENSION:  4
Step: 23
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 6.666666666666667, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 25 DIMENSION:  4
Step: 24
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 26 DIMENSION:  4
Step: 25
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 27 DIMENSION:  4
Step: 26
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [100, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 28 DIMENSION:  4
Step: 27
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [100, 14.285714285714286, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 29 DIMENSION:  4
Step: 28
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 30 DIMENSION:  4
Step: 29
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:38:57.418] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 31 DIMENSION:  4
Step: 30
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 32 DIMENSION:  4
Step: 31
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 33 DIMENSION:  4
Step: 32
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 34 DIMENSION:  4
Step: 33
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 35 DIMENSION:  4
Step: 34
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [33.333333333333336, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 36 DIMENSION:  4
Step: 35
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 37 DIMENSION:  4
Step: 36
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 8, 4, 8], 'bandwidth': [50, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 38 DIMENSION:  4
Step: 37
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 39 DIMENSION:  4
Step: 38
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 40 DIMENSION:  4
Step: 39
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 41 DIMENSION:  4
Step: 40
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:39:29.856] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:39:29.856] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:39:29.856] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:39:29.856] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:39:29.857] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 42 DIMENSION:  4
Step: 41
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [33.333333333333336, 14.285714285714286, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 43 DIMENSION:  4
Step: 42
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 44 DIMENSION:  4
Step: 43
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [14.285714285714286, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 45 DIMENSION:  4
Step: 44
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [50, 33.333333333333336, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 46 DIMENSION:  4
Step: 45
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [100, 6.666666666666667, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 47 DIMENSION:  4
Step: 46
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [100, 33.333333333333336, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 48 DIMENSION:  4
Step: 47
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [14.285714285714286, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 49 DIMENSION:  4
Step: 48
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 50 DIMENSION:  4
Step: 49
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [14.285714285714286, 50, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 51 DIMENSION:  4
Step: 50
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 52 DIMENSION:  4
Step: 51
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [14.285714285714286, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 53 DIMENSION:  4
Step: 52
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 54 DIMENSION:  4
Step: 53
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [6.666666666666667, 14.285714285714286, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 55 DIMENSION:  4
Step: 54
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 56 DIMENSION:  4
Step: 55
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [14.285714285714286, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 57 DIMENSION:  4
Step: 56
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:40:03.307] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 58 DIMENSION:  4
Step: 57
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 14.285714285714286, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [14.285714285714286, 14.285714285714286, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 59 DIMENSION:  4
Step: 58
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:40:36.743] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 60 DIMENSION:  4
Step: 59
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [33.333333333333336, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 61 DIMENSION:  4
Step: 60
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 62 DIMENSION:  4
Step: 61
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:41:09.430] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 63 DIMENSION:  4
Step: 62
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [50, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [50, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:41:42.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 64 DIMENSION:  4
Step: 63
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 65 DIMENSION:  4
Step: 64
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 66 DIMENSION:  4
Step: 65
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [6.666666666666667, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 67 DIMENSION:  4
Step: 66
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [50, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [50, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:15.706] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 68 DIMENSION:  4
Step: 67
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 69 DIMENSION:  4
Step: 68
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [14.285714285714286, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 70 DIMENSION:  4
Step: 69
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 6.666666666666667, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [33.333333333333336, 50, 6.666666666666667, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 71 DIMENSION:  4
Step: 70
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [50, 50, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 72 DIMENSION:  4
Step: 71
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 4, 8], 'bandwidth': [6.666666666666667, 14.285714285714286, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 73 DIMENSION:  4
Step: 72
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 6.666666666666667, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 74 DIMENSION:  4
Step: 73
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 75 DIMENSION:  4
Step: 74
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [50, 6.666666666666667, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 76 DIMENSION:  4
Step: 75
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 77 DIMENSION:  4
Step: 76
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 78 DIMENSION:  4
Step: 77
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 79 DIMENSION:  4
Step: 78
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 80 DIMENSION:  4
Step: 79
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 81 DIMENSION:  4
Step: 80
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 82 DIMENSION:  4
Step: 81
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 83 DIMENSION:  4
Step: 82
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 84 DIMENSION:  4
Step: 83
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:42:49.366] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 85 DIMENSION:  4
Step: 84
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [100, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 86 DIMENSION:  4
Step: 85
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [14.285714285714286, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus_count': [8, 4, 8, 4], 'bandwidth': [14.285714285714286, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:22.654] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 87 DIMENSION:  4
Step: 86
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 100, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 88 DIMENSION:  4
Step: 87
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [100, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 89 DIMENSION:  4
Step: 88
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [50, 14.285714285714286, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 90 DIMENSION:  4
Step: 89
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 91 DIMENSION:  4
Step: 90
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 4, 8], 'bandwidth': [100, 14.285714285714286, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus_count': [4, 8, 4, 8], 'bandwidth': [100, 14.285714285714286, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:43:56.101] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 92 DIMENSION:  4
Step: 91
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 93 DIMENSION:  4
Step: 92
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [50, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 94 DIMENSION:  4
Step: 93
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 95 DIMENSION:  4
Step: 94
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [6.666666666666667, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 96 DIMENSION:  4
Step: 95
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [6.666666666666667, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 97 DIMENSION:  4
Step: 96
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [50, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 98 DIMENSION:  4
Step: 97
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [6.666666666666667, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 99 DIMENSION:  4
Step: 98
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [50, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 100 DIMENSION:  4
Step: 99
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 101 DIMENSION:  4
Step: 100
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [6.666666666666667, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 102 DIMENSION:  4
Step: 101
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 4, 8], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus_count': [4, 8, 4, 8], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:44:29.776] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 103 DIMENSION:  4
Step: 102
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 14.285714285714286, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 4, 8], 'bandwidth': [14.285714285714286, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 104 DIMENSION:  4
Step: 103
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:03.248] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 105 DIMENSION:  4
Step: 104
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 6.666666666666667, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [6.666666666666667, 100, 6.666666666666667, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 106 DIMENSION:  4
Step: 105
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [50, 14.285714285714286, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 107 DIMENSION:  4
Step: 106
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 108 DIMENSION:  4
Step: 107
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [14.285714285714286, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 109 DIMENSION:  4
Step: 108
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 110 DIMENSION:  4
Step: 109
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [6.666666666666667, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 111 DIMENSION:  4
Step: 110
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 112 DIMENSION:  4
Step: 111
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [6.666666666666667, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 113 DIMENSION:  4
Step: 112
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [33.333333333333336, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 114 DIMENSION:  4
Step: 113
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 115 DIMENSION:  4
Step: 114
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 33.333333333333336, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 116 DIMENSION:  4
Step: 115
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 117 DIMENSION:  4
Step: 116
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [14.285714285714286, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 118 DIMENSION:  4
Step: 117
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 33.333333333333336, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 119 DIMENSION:  4
Step: 118
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 120 DIMENSION:  4
Step: 119
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 121 DIMENSION:  4
Step: 120
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 122 DIMENSION:  4
Step: 121
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [14.285714285714286, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 123 DIMENSION:  4
Step: 122
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:45:36.485] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:45:36.485] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:45:36.486] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 124 DIMENSION:  4
Step: 123
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [33.333333333333336, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 125 DIMENSION:  4
Step: 124
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [6.666666666666667, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 126 DIMENSION:  4
Step: 125
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:46:09.192] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:09.193] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 127 DIMENSION:  4
Step: 126
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 128 DIMENSION:  4
Step: 127
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 129 DIMENSION:  4
Step: 128
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Ring'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [33.333333333333336, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 130 DIMENSION:  4
Step: 129
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [100, 6.666666666666667, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 131 DIMENSION:  4
Step: 130
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus_count': [4, 4, 4, 16], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:46:41.917] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 132 DIMENSION:  4
Step: 131
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [50, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 133 DIMENSION:  4
Step: 132
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [6.666666666666667, 50, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 134 DIMENSION:  4
Step: 133
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [50, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 135 DIMENSION:  4
Step: 134
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [14.285714285714286, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 136 DIMENSION:  4
Step: 135
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [14.285714285714286, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 137 DIMENSION:  4
Step: 136
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 138 DIMENSION:  4
Step: 137
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [14.285714285714286, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 139 DIMENSION:  4
Step: 138
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [50, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 140 DIMENSION:  4
Step: 139
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 141 DIMENSION:  4
Step: 140
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [50, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 142 DIMENSION:  4
Step: 141
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [100, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 143 DIMENSION:  4
Step: 142
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 50, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 144 DIMENSION:  4
Step: 143
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [14.285714285714286, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 145 DIMENSION:  4
Step: 144
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 4, 4], 'bandwidth': [14.285714285714286, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 146 DIMENSION:  4
Step: 145
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 147 DIMENSION:  4
Step: 146
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 148 DIMENSION:  4
Step: 147
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [50, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 149 DIMENSION:  4
Step: 148
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [50, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 150 DIMENSION:  4
Step: 149
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 151 DIMENSION:  4
Step: 150
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:47:15.022] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:47:15.022] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:15.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 152 DIMENSION:  4
Step: 151
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 153 DIMENSION:  4
Step: 152
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [100, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 154 DIMENSION:  4
Step: 153
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 155 DIMENSION:  4
Step: 154
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:47:47.757] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 156 DIMENSION:  4
Step: 155
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [50, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 157 DIMENSION:  4
Step: 156
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 158 DIMENSION:  4
Step: 157
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [50, 50, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 159 DIMENSION:  4
Step: 158
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 33.333333333333336, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [14.285714285714286, 33.333333333333336, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 160 DIMENSION:  4
Step: 159
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 161 DIMENSION:  4
Step: 160
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 33.333333333333336, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [14.285714285714286, 33.333333333333336, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 162 DIMENSION:  4
Step: 161
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 163 DIMENSION:  4
Step: 162
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 164 DIMENSION:  4
Step: 163
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 165 DIMENSION:  4
Step: 164
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [100, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 166 DIMENSION:  4
Step: 165
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:48:21.210] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 167 DIMENSION:  4
Step: 166
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 168 DIMENSION:  4
Step: 167
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 169 DIMENSION:  4
Step: 168
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:48:54.007] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 170 DIMENSION:  4
Step: 169
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 8, 4, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus_count': [4, 8, 4, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:49:27.144] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 171 DIMENSION:  4
Step: 170
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 4, 8], 'bandwidth': [6.666666666666667, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 172 DIMENSION:  4
Step: 171
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 173 DIMENSION:  4
Step: 172
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 174 DIMENSION:  4
Step: 173
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [33.333333333333336, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 175 DIMENSION:  4
Step: 174
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 176 DIMENSION:  4
Step: 175
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [50, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 177 DIMENSION:  4
Step: 176
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 178 DIMENSION:  4
Step: 177
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [100, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 179 DIMENSION:  4
Step: 178
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 180 DIMENSION:  4
Step: 179
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 50, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 181 DIMENSION:  4
Step: 180
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 182 DIMENSION:  4
Step: 181
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [6.666666666666667, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 183 DIMENSION:  4
Step: 182
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:50:00.095] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 184 DIMENSION:  4
Step: 183
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 185 DIMENSION:  4
Step: 184
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 50, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 186 DIMENSION:  4
Step: 185
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [33.333333333333336, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 187 DIMENSION:  4
Step: 186
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [33.333333333333336, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 188 DIMENSION:  4
Step: 187
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [50, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 189 DIMENSION:  4
Step: 188
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 190 DIMENSION:  4
Step: 189
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 191 DIMENSION:  4
Step: 190
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [6.666666666666667, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 192 DIMENSION:  4
Step: 191
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:50:33.211] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 193 DIMENSION:  4
Step: 192
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 194 DIMENSION:  4
Step: 193
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [50, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 195 DIMENSION:  4
Step: 194
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 196 DIMENSION:  4
Step: 195
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 4, 4], 'bandwidth': [100, 6.666666666666667, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 197 DIMENSION:  4
Step: 196
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [100, 50, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 198 DIMENSION:  4
Step: 197
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 199 DIMENSION:  4
Step: 198
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [6.666666666666667, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 200 DIMENSION:  4
Step: 199
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [100, 6.666666666666667, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 201 DIMENSION:  4
Step: 200
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 202 DIMENSION:  4
Step: 201
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 4, 4], 'bandwidth': [50, 6.666666666666667, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 203 DIMENSION:  4
Step: 202
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 204 DIMENSION:  4
Step: 203
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 6.666666666666667, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [6.666666666666667, 6.666666666666667, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 205 DIMENSION:  4
Step: 204
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 16, 4], 'bandwidth': [50, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 206 DIMENSION:  4
Step: 205
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [50, 14.285714285714286, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 207 DIMENSION:  4
Step: 206
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 208 DIMENSION:  4
Step: 207
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [50, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 209 DIMENSION:  4
Step: 208
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [50, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [50, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:51:06.322] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 210 DIMENSION:  4
Step: 209
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [50, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 211 DIMENSION:  4
Step: 210
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 212 DIMENSION:  4
Step: 211
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [33.333333333333336, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 213 DIMENSION:  4
Step: 212
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 4, 4, 4], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 214 DIMENSION:  4
Step: 213
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [14.285714285714286, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 215 DIMENSION:  4
Step: 214
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [50, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 216 DIMENSION:  4
Step: 215
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 50, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 217 DIMENSION:  4
Step: 216
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [50, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 218 DIMENSION:  4
Step: 217
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 219 DIMENSION:  4
Step: 218
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 220 DIMENSION:  4
Step: 219
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 221 DIMENSION:  4
Step: 220
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [100, 50, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 222 DIMENSION:  4
Step: 221
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus_count': [4, 4, 4, 16], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:51:39.632] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 223 DIMENSION:  4
Step: 222
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 33.333333333333336, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:12.570] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 224 DIMENSION:  4
Step: 223
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 225 DIMENSION:  4
Step: 224
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 226 DIMENSION:  4
Step: 225
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [14.285714285714286, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 227 DIMENSION:  4
Step: 226
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [50, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 228 DIMENSION:  4
Step: 227
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [50, 33.333333333333336, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 229 DIMENSION:  4
Step: 228
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus_count': [8, 4, 8, 4], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:52:45.714] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 230 DIMENSION:  4
Step: 229
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 231 DIMENSION:  4
Step: 230
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 232 DIMENSION:  4
Step: 231
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [100, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 233 DIMENSION:  4
Step: 232
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 234 DIMENSION:  4
Step: 233
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [33.333333333333336, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 235 DIMENSION:  4
Step: 234
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:18.969] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 236 DIMENSION:  4
Step: 235
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [33.333333333333336, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus_count': [4, 4, 4, 16], 'bandwidth': [33.333333333333336, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:53:51.848] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 237 DIMENSION:  4
Step: 236
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 16, 4, 4], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 238 DIMENSION:  4
Step: 237
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [100, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 239 DIMENSION:  4
Step: 238
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 4, 16], 'bandwidth': [100, 33.333333333333336, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 240 DIMENSION:  4
Step: 239
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [100, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 241 DIMENSION:  4
Step: 240
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [6.666666666666667, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 242 DIMENSION:  4
Step: 241
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [33.333333333333336, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [33.333333333333336, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 20:54:25.077] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 243 DIMENSION:  4
Step: 242
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [50, 14.285714285714286, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 244 DIMENSION:  4
Step: 243
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [14.285714285714286, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 245 DIMENSION:  4
Step: 244
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 246 DIMENSION:  4
Step: 245
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 247 DIMENSION:  4
Step: 246
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [100, 50, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 248 DIMENSION:  4
Step: 247
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [14.285714285714286, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 249 DIMENSION:  4
Step: 248
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [33.333333333333336, 33.333333333333336, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 250 DIMENSION:  4
Step: 249
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [50, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 251 DIMENSION:  4
Step: 250
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:54:57.977] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 252 DIMENSION:  4
Step: 251
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [50, 14.285714285714286, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 253 DIMENSION:  4
Step: 252
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 254 DIMENSION:  4
Step: 253
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [33.333333333333336, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 255 DIMENSION:  4
Step: 254
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 256 DIMENSION:  4
Step: 255
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 50, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 257 DIMENSION:  4
Step: 256
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [6.666666666666667, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 258 DIMENSION:  4
Step: 257
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [50, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 259 DIMENSION:  4
Step: 258
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [33.333333333333336, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [33.333333333333336, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:55:31.124] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 260 DIMENSION:  4
Step: 259
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [50, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 261 DIMENSION:  4
Step: 260
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [33.333333333333336, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 262 DIMENSION:  4
Step: 261
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 263 DIMENSION:  4
Step: 262
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 264 DIMENSION:  4
Step: 263
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 265 DIMENSION:  4
Step: 264
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [33.333333333333336, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 266 DIMENSION:  4
Step: 265
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 267 DIMENSION:  4
Step: 266
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [100, 6.666666666666667, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 268 DIMENSION:  4
Step: 267
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [50, 100, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 269 DIMENSION:  4
Step: 268
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [100, 6.666666666666667, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 270 DIMENSION:  4
Step: 269
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 271 DIMENSION:  4
Step: 270
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [100, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 272 DIMENSION:  4
Step: 271
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [100, 6.666666666666667, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 273 DIMENSION:  4
Step: 272
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 274 DIMENSION:  4
Step: 273
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [50, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 275 DIMENSION:  4
Step: 274
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [33.333333333333336, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 276 DIMENSION:  4
Step: 275
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [100, 6.666666666666667, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 277 DIMENSION:  4
Step: 276
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 278 DIMENSION:  4
Step: 277
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 279 DIMENSION:  4
Step: 278
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:03.748] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 280 DIMENSION:  4
Step: 279
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 281 DIMENSION:  4
Step: 280
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 16, 16, 16], 'bandwidth': [14.285714285714286, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 282 DIMENSION:  4
Step: 281
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 283 DIMENSION:  4
Step: 282
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 16, 16], 'bandwidth': [100, 50, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 284 DIMENSION:  4
Step: 283
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 285 DIMENSION:  4
Step: 284
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 286 DIMENSION:  4
Step: 285
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [6.666666666666667, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 287 DIMENSION:  4
Step: 286
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [100, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 288 DIMENSION:  4
Step: 287
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 289 DIMENSION:  4
Step: 288
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 290 DIMENSION:  4
Step: 289
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 291 DIMENSION:  4
Step: 290
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 292 DIMENSION:  4
Step: 291
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 293 DIMENSION:  4
Step: 292
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 294 DIMENSION:  4
Step: 293
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [100, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [100, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 20:56:36.820] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 295 DIMENSION:  4
Step: 294
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 296 DIMENSION:  4
Step: 295
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 297 DIMENSION:  4
Step: 296
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 298 DIMENSION:  4
Step: 297
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [50, 100, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 299 DIMENSION:  4
Step: 298
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 4, 16], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 300 DIMENSION:  4
Step: 299
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [14.285714285714286, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 301 DIMENSION:  4
Step: 300
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 302 DIMENSION:  4
Step: 301
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 303 DIMENSION:  4
Step: 302
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 304 DIMENSION:  4
Step: 303
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:57:09.591] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 305 DIMENSION:  4
Step: 304
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [33.333333333333336, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 306 DIMENSION:  4
Step: 305
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 307 DIMENSION:  4
Step: 306
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 308 DIMENSION:  4
Step: 307
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 309 DIMENSION:  4
Step: 308
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [50, 100, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 20:57:42.284] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 310 DIMENSION:  4
Step: 309
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [100, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 311 DIMENSION:  4
Step: 310
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [100, 33.333333333333336, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 312 DIMENSION:  4
Step: 311
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 313 DIMENSION:  4
Step: 312
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [14.285714285714286, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 314 DIMENSION:  4
Step: 313
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 33.333333333333336, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [100, 6.666666666666667, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 315 DIMENSION:  4
Step: 314
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 316 DIMENSION:  4
Step: 315
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 317 DIMENSION:  4
Step: 316
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 318 DIMENSION:  4
Step: 317
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [6.666666666666667, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 319 DIMENSION:  4
Step: 318
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [50, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus_count': [4, 4, 8, 8], 'bandwidth': [50, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:13.814] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 320 DIMENSION:  4
Step: 319
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [33.333333333333336, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 321 DIMENSION:  4
Step: 320
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [33.333333333333336, 6.666666666666667, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 322 DIMENSION:  4
Step: 321
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 20:58:46.862] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 323 DIMENSION:  4
Step: 322
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 324 DIMENSION:  4
Step: 323
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 325 DIMENSION:  4
Step: 324
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [50, 50, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 326 DIMENSION:  4
Step: 325
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 327 DIMENSION:  4
Step: 326
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 16, 8], 'bandwidth': [6.666666666666667, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 328 DIMENSION:  4
Step: 327
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [50, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 329 DIMENSION:  4
Step: 328
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 330 DIMENSION:  4
Step: 329
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [14.285714285714286, 100, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 331 DIMENSION:  4
Step: 330
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 332 DIMENSION:  4
Step: 331
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:20.280] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 333 DIMENSION:  4
Step: 332
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [100, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 334 DIMENSION:  4
Step: 333
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 335 DIMENSION:  4
Step: 334
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 336 DIMENSION:  4
Step: 335
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 337 DIMENSION:  4
Step: 336
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 16, 4], 'bandwidth': [50, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 338 DIMENSION:  4
Step: 337
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 339 DIMENSION:  4
Step: 338
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [50, 14.285714285714286, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 340 DIMENSION:  4
Step: 339
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [100, 6.666666666666667, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 341 DIMENSION:  4
Step: 340
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 14.285714285714286, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 342 DIMENSION:  4
Step: 341
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [33.333333333333336, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 343 DIMENSION:  4
Step: 342
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 344 DIMENSION:  4
Step: 343
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [14.285714285714286, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 345 DIMENSION:  4
Step: 344
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 346 DIMENSION:  4
Step: 345
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [50, 6.666666666666667, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 347 DIMENSION:  4
Step: 346
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [33.333333333333336, 14.285714285714286, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 348 DIMENSION:  4
Step: 347
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [100, 6.666666666666667, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 349 DIMENSION:  4
Step: 348
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 33.333333333333336, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 8, 8], 'bandwidth': [6.666666666666667, 33.333333333333336, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 350 DIMENSION:  4
Step: 349
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 351 DIMENSION:  4
Step: 350
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [14.285714285714286, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 352 DIMENSION:  4
Step: 351
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 353 DIMENSION:  4
Step: 352
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus_count': [8, 4, 8, 4], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 20:59:53.325] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 354 DIMENSION:  4
Step: 353
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [100, 14.285714285714286, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 355 DIMENSION:  4
Step: 354
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 356 DIMENSION:  4
Step: 355
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [33.333333333333336, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 357 DIMENSION:  4
Step: 356
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [50, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 358 DIMENSION:  4
Step: 357
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [100, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 359 DIMENSION:  4
Step: 358
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [14.285714285714286, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 360 DIMENSION:  4
Step: 359
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 361 DIMENSION:  4
Step: 360
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 362 DIMENSION:  4
Step: 361
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [14.285714285714286, 6.666666666666667, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 363 DIMENSION:  4
Step: 362
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 364 DIMENSION:  4
Step: 363
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 365 DIMENSION:  4
Step: 364
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [33.333333333333336, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 366 DIMENSION:  4
Step: 365
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [6.666666666666667, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 367 DIMENSION:  4
Step: 366
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 368 DIMENSION:  4
Step: 367
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [6.666666666666667, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 369 DIMENSION:  4
Step: 368
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 16
[2024-04-11 21:00:26.871] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 370 DIMENSION:  4
Step: 369
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [14.285714285714286, 6.666666666666667, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 371 DIMENSION:  4
Step: 370
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [50, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 372 DIMENSION:  4
Step: 371
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [100, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 373 DIMENSION:  4
Step: 372
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [33.333333333333336, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 374 DIMENSION:  4
Step: 373
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [50, 6.666666666666667, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 375 DIMENSION:  4
Step: 374
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [6.666666666666667, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 376 DIMENSION:  4
Step: 375
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [50, 14.285714285714286, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 377 DIMENSION:  4
Step: 376
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [6.666666666666667, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 378 DIMENSION:  4
Step: 377
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [50, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 379 DIMENSION:  4
Step: 378
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [100, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 380 DIMENSION:  4
Step: 379
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 381 DIMENSION:  4
Step: 380
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [33.333333333333336, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 382 DIMENSION:  4
Step: 381
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 383 DIMENSION:  4
Step: 382
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [50, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 384 DIMENSION:  4
Step: 383
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 385 DIMENSION:  4
Step: 384
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 386 DIMENSION:  4
Step: 385
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [50, 50, 6.666666666666667, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 387 DIMENSION:  4
Step: 386
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 8, 4, 8], 'bandwidth': [33.333333333333336, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus_count': [4, 8, 4, 8], 'bandwidth': [33.333333333333336, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:01:00.344] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 388 DIMENSION:  4
Step: 387
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus_count': [4, 4, 4, 16], 'bandwidth': [50, 33.333333333333336, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:01:33.458] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 389 DIMENSION:  4
Step: 388
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 390 DIMENSION:  4
Step: 389
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 391 DIMENSION:  4
Step: 390
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 392 DIMENSION:  4
Step: 391
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [100, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 393 DIMENSION:  4
Step: 392
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [6.666666666666667, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 394 DIMENSION:  4
Step: 393
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 395 DIMENSION:  4
Step: 394
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 396 DIMENSION:  4
Step: 395
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [14.285714285714286, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 397 DIMENSION:  4
Step: 396
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 398 DIMENSION:  4
Step: 397
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 399 DIMENSION:  4
Step: 398
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 400 DIMENSION:  4
Step: 399
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [50, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 401 DIMENSION:  4
Step: 400
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 402 DIMENSION:  4
Step: 401
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 403 DIMENSION:  4
Step: 402
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 404 DIMENSION:  4
Step: 403
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [6.666666666666667, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 405 DIMENSION:  4
Step: 404
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [6.666666666666667, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 406 DIMENSION:  4
Step: 405
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 407 DIMENSION:  4
Step: 406
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 408 DIMENSION:  4
Step: 407
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 4, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 409 DIMENSION:  4
Step: 408
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 410 DIMENSION:  4
Step: 409
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 33.333333333333336, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [33.333333333333336, 33.333333333333336, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 411 DIMENSION:  4
Step: 410
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [50, 33.333333333333336, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 412 DIMENSION:  4
Step: 411
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [6.666666666666667, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 413 DIMENSION:  4
Step: 412
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [50, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 414 DIMENSION:  4
Step: 413
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 415 DIMENSION:  4
Step: 414
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 50, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 416 DIMENSION:  4
Step: 415
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [50, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 417 DIMENSION:  4
Step: 416
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 6.666666666666667, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [6.666666666666667, 6.666666666666667, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 418 DIMENSION:  4
Step: 417
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 6.666666666666667, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [33.333333333333336, 100, 6.666666666666667, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 419 DIMENSION:  4
Step: 418
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 33.333333333333336, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 100, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 420 DIMENSION:  4
Step: 419
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [6.666666666666667, 14.285714285714286, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 421 DIMENSION:  4
Step: 420
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [14.285714285714286, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 422 DIMENSION:  4
Step: 421
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [50, 6.666666666666667, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 423 DIMENSION:  4
Step: 422
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [50, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [50, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:07.360] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 424 DIMENSION:  4
Step: 423
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 425 DIMENSION:  4
Step: 424
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [100, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus_count': [4, 4, 4, 16], 'bandwidth': [100, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:41.003] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 4
[2024-04-11 21:02:41.004] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 426 DIMENSION:  4
Step: 425
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [33.333333333333336, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 427 DIMENSION:  4
Step: 426
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 428 DIMENSION:  4
Step: 427
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [50, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 429 DIMENSION:  4
Step: 428
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 430 DIMENSION:  4
Step: 429
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 431 DIMENSION:  4
Step: 430
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 432 DIMENSION:  4
Step: 431
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [14.285714285714286, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 433 DIMENSION:  4
Step: 432
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 8, 16, 8], 'bandwidth': [100, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 434 DIMENSION:  4
Step: 433
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [50, 6.666666666666667, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 435 DIMENSION:  4
Step: 434
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 436 DIMENSION:  4
Step: 435
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [14.285714285714286, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 437 DIMENSION:  4
Step: 436
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:14.635] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 438 DIMENSION:  4
Step: 437
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:03:48.079] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:03:48.079] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 4
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:03:48.080] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 439 DIMENSION:  4
Step: 438
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 440 DIMENSION:  4
Step: 439
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 8, 16, 8], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 441 DIMENSION:  4
Step: 440
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 8], 'bandwidth': [50, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 442 DIMENSION:  4
Step: 441
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [100, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 443 DIMENSION:  4
Step: 442
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [50, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [50, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:04:21.885] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 444 DIMENSION:  4
Step: 443
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 445 DIMENSION:  4
Step: 444
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 446 DIMENSION:  4
Step: 445
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [50, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 447 DIMENSION:  4
Step: 446
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 448 DIMENSION:  4
Step: 447
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [50, 33.333333333333336, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 449 DIMENSION:  4
Step: 448
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 16, 16, 4], 'bandwidth': [33.333333333333336, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 450 DIMENSION:  4
Step: 449
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [6.666666666666667, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 451 DIMENSION:  4
Step: 450
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [50, 6.666666666666667, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 452 DIMENSION:  4
Step: 451
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 453 DIMENSION:  4
Step: 452
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [16, 16, 4, 4], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 454 DIMENSION:  4
Step: 453
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 455 DIMENSION:  4
Step: 454
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [14.285714285714286, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 456 DIMENSION:  4
Step: 455
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 457 DIMENSION:  4
Step: 456
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [50, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 458 DIMENSION:  4
Step: 457
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-04-11 21:04:55.810] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 459 DIMENSION:  4
Step: 458
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [14.285714285714286, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 460 DIMENSION:  4
Step: 459
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [14.285714285714286, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 461 DIMENSION:  4
Step: 460
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [100, 100, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 462 DIMENSION:  4
Step: 461
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 463 DIMENSION:  4
Step: 462
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 464 DIMENSION:  4
Step: 463
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [100, 50, 6.666666666666667, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 465 DIMENSION:  4
Step: 464
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [100, 6.666666666666667, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 466 DIMENSION:  4
Step: 465
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 4, 4], 'bandwidth': [100, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 467 DIMENSION:  4
Step: 466
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [6.666666666666667, 50, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 468 DIMENSION:  4
Step: 467
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 469 DIMENSION:  4
Step: 468
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [100, 14.285714285714286, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 470 DIMENSION:  4
Step: 469
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 471 DIMENSION:  4
Step: 470
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 472 DIMENSION:  4
Step: 471
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 16, 4], 'bandwidth': [50, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 473 DIMENSION:  4
Step: 472
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 474 DIMENSION:  4
Step: 473
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus_count': [8, 4, 8, 4], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:05:29.122] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 475 DIMENSION:  4
Step: 474
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [14.285714285714286, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 476 DIMENSION:  4
Step: 475
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 8, 16, 4], 'bandwidth': [14.285714285714286, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 477 DIMENSION:  4
Step: 476
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [50, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 478 DIMENSION:  4
Step: 477
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [6.666666666666667, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 479 DIMENSION:  4
Step: 478
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [6.666666666666667, 50, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 480 DIMENSION:  4
Step: 479
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 6.666666666666667, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 481 DIMENSION:  4
Step: 480
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [50, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 482 DIMENSION:  4
Step: 481
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [6.666666666666667, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 483 DIMENSION:  4
Step: 482
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [100, 50, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 484 DIMENSION:  4
Step: 483
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [100, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 485 DIMENSION:  4
Step: 484
REWARD FORMULATION:  both
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 486 DIMENSION:  4
Step: 485
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 487 DIMENSION:  4
Step: 486
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 488 DIMENSION:  4
Step: 487
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 489 DIMENSION:  4
Step: 488
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 490 DIMENSION:  4
Step: 489
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [100, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 491 DIMENSION:  4
Step: 490
REWARD FORMULATION:  both
network bandwidth:  [50, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'ring', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 492 DIMENSION:  4
Step: 491
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 493 DIMENSION:  4
Step: 492
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [50, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 494 DIMENSION:  4
Step: 493
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 50, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [33.333333333333336, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 495 DIMENSION:  4
Step: 494
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 496 DIMENSION:  4
Step: 495
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 497 DIMENSION:  4
Step: 496
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [50, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 498 DIMENSION:  4
Step: 497
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [100, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 499 DIMENSION:  4
Step: 498
REWARD FORMULATION:  both
network bandwidth:  [50, 6.666666666666667, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [50, 6.666666666666667, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 500 DIMENSION:  4
Step: 499
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 33.333333333333336, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus_count': [8, 8, 4, 4], 'bandwidth': [14.285714285714286, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 8
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-04-11 21:06:02.664] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 501 DIMENSION:  4
Step: 500
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:06:35.023] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 502 DIMENSION:  4
Step: 501
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'ring'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 503 DIMENSION:  4
Step: 502
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['ring', 'ring', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [6.666666666666667, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 504 DIMENSION:  4
Step: 503
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 50, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 505 DIMENSION:  4
Step: 504
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [14.285714285714286, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 506 DIMENSION:  4
Step: 505
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 6.666666666666667, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [14.285714285714286, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 507 DIMENSION:  4
Step: 506
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 508 DIMENSION:  4
Step: 507
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 33.333333333333336, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-04-11 21:07:08.251] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 509 DIMENSION:  4
Step: 508
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 510 DIMENSION:  4
Step: 509
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 511 DIMENSION:  4
Step: 510
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 14.285714285714286, 100, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 4, 4], 'bandwidth': [6.666666666666667, 14.285714285714286, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 512 DIMENSION:  4
Step: 511
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [50, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 513 DIMENSION:  4
Step: 512
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 6.666666666666667, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [50, 50, 6.666666666666667, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 514 DIMENSION:  4
Step: 513
REWARD FORMULATION:  both
network bandwidth:  [50, 14.285714285714286, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'doubleBinaryTree', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [50, 14.285714285714286, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 515 DIMENSION:  4
Step: 514
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 100, 14.285714285714286, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [16, 4, 8, 8], 'bandwidth': [6.666666666666667, 100, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 516 DIMENSION:  4
Step: 515
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 517 DIMENSION:  4
Step: 516
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [33.333333333333336, 50, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:07:41.371] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 518 DIMENSION:  4
Step: 517
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 6.666666666666667, 100, 6.666666666666667]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'direct', 'halvingDoubling', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 16, 16], 'bandwidth': [14.285714285714286, 6.666666666666667, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 519 DIMENSION:  4
Step: 518
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [100, 14.285714285714286, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 520 DIMENSION:  4
Step: 519
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 16, 16, 16], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 521 DIMENSION:  4
Step: 520
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 100, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 522 DIMENSION:  4
Step: 521
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 16, 16], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 523 DIMENSION:  4
Step: 522
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 14.285714285714286, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [50, 100, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [50, 100, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 21:08:14.747] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 524 DIMENSION:  4
Step: 523
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 100, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 525 DIMENSION:  4
Step: 524
REWARD FORMULATION:  both
network bandwidth:  [50, 50, 14.285714285714286, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [50, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 526 DIMENSION:  4
Step: 525
REWARD FORMULATION:  both
network bandwidth:  [50, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 4, 16, 4], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['doubleBinaryTree', 'doubleBinaryTree', 'direct', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus_count': [4, 4, 16, 4], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
[0mtrain_randomwalker_astra_sim
Shell Command python trainRandomWalkerAstraSim.py --workload=resnet18 --num_steps=50000 --use_envlogger=False --summary_dir=./all_logs/472e812c5b61 --reward_formulation=both --knobs=astrasim_220_example/knobs_4.py --congestion_aware=True --network=astrasim_220_example/network_input_4.yml --system=astrasim_220_example/system_input_4.json --workload_file=astrasim_220_example/workload_cfg_4.json 
