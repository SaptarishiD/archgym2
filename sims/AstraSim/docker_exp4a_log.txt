standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 16
[2024-04-11 04:49:43.451] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 94 DIMENSION:  4
Step: 93
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 33.333333333333336, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [100, 50, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 95 DIMENSION:  4
Step: 94
REWARD FORMULATION:  both
network bandwidth:  [100, 33.333333333333336, 50, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'doubleBinaryTree', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 96 DIMENSION:  4
Step: 95
REWARD FORMULATION:  both
network bandwidth:  [100, 50, 6.666666666666667, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 8, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 16, 16, 4], 'bandwidth': [100, 50, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 97 DIMENSION:  4
Step: 96
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [33.333333333333336, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 98 DIMENSION:  4
Step: 97
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 50, 14.285714285714286, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'doubleBinaryTree', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 8, 4], 'bandwidth': [14.285714285714286, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 99 DIMENSION:  4
Step: 98
REWARD FORMULATION:  both
network bandwidth:  [100, 100, 50, 50]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 16, 8, 8], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 100 DIMENSION:  4
Step: 99
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 14.285714285714286, 100, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 16, 'all-reduce-implementation': ['doubleBinaryTree', 'ring', 'direct', 'doubleBinaryTree'], 'all-gather-implementation': ['doubleBinaryTree', 'ring', 'direct', 'doubleBinaryTree'], 'reduce-scatter-implementation': ['doubleBinaryTree', 'ring', 'direct', 'doubleBinaryTree'], 'all-to-all-implementation': ['doubleBinaryTree', 'ring', 'direct', 'doubleBinaryTree'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [4, 8, 8, 8], 'bandwidth': [33.333333333333336, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 101 DIMENSION:  4
Step: 100
REWARD FORMULATION:  both
network bandwidth:  [100, 14.285714285714286, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus_count': [4, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}
/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json
OUT:  b'SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: FALSE\nSH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: FALSE
SH MEMORY: /workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /workdir/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 1
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 4
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-04-11 04:50:17.527] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
done script

MAX_CYCLES:  0
MAX_PEAK_MEM:  0
------------------------------------------------------------------
Calculating reward...
['0.e+00' '0.e+00']
2.0
3.0
observations:  ['0.e+00' '0.e+00']
reward:  0.5773502691896258
DIMENSION:  4
0 102 DIMENSION:  4
Step: 101
REWARD FORMULATION:  both
network bandwidth:  [14.285714285714286, 100, 100, 14.285714285714286]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [14.285714285714286, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 103 DIMENSION:  4
Step: 102
REWARD FORMULATION:  both
network bandwidth:  [6.666666666666667, 50, 50, 33.333333333333336]
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'doubleBinaryTree', 'doubleBinaryTree', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [6.666666666666667, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 104 DIMENSION:  4
Step: 103
REWARD FORMULATION:  both
network bandwidth:  [33.333333333333336, 50, 33.333333333333336, 100]
DERIVED action_dict:  {'system': {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'path': '/workdir/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_4.json'}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
Running simulation...
all configs:  {'scheduling-policy': 'FIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 2, 'all-reduce-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'doubleBinaryTree', 'direct', 'direct'], 'collective-optimization': 'localBWAware', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50} {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus_count': [4, 16, 4, 4], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]} {'num_npus': 1024, 'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 96}